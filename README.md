# SEO 自動檢查工具

自動化 Google 搜尋排名追蹤工具，用於批次查詢關鍵字的搜尋結果並記錄前十名排名資料。

## 功能特點

- **批次關鍵字搜尋**：從 Excel 檔案讀取多個關鍵字，自動執行 Google 搜尋
- **排名追蹤**：抓取並記錄每個關鍵字的前 10 名搜尋結果
- **自動化記錄**：搜尋結果自動儲存至 Excel，按月份分頁管理
- **歷史資料管理**：支援每日執行，累積歷史排名資料以便分析趨勢
- **無痕模式搜尋**：使用 Chrome 無痕模式，減少個人化搜尋影響

## 系統需求

- **作業系統**：macOS（包含 AppleScript 整合）
- **Python 版本**：Python 3.7+
- **瀏覽器**：Google Chrome
- **ChromeDriver**：與 Chrome 版本相容的 ChromeDriver

## 安裝步驟

### 1. 建立虛擬環境

```bash
cd seo_auto_check
python3 -m venv venv
source venv/bin/activate  # 啟動虛擬環境
```

### 2. 安裝相依套件

```bash
./venv/bin/pip install openpyxl selenium
```

### 3. 確認 Chrome 已安裝

確保系統已安裝 Google Chrome 瀏覽器。

## 使用方法

### 步驟 1：準備關鍵字檔案

建立或編輯 `seo_search_keyword.xlsx`，格式如下：

| A 欄（空白） | B 欄：KEYWORDS |
|-------------|----------------|
|             | 紅外光譜儀      |
|             | 分光光度計      |
|             | 精密烘箱        |
|             | ftir           |

**注意**：
- 第一列為標題列（KEYWORDS）
- 關鍵字從第二列開始填寫於 **B 欄**
- A 欄保持空白

### 步驟 2：執行程式

```bash
# 方法 1：使用虛擬環境的 Python
./venv/bin/python seo_auto_check.py

# 方法 2：啟動虛擬環境後執行
source venv/bin/activate
python seo_auto_check.py
```

### 步驟 3：查看結果

執行完成後，開啟 `seo_search_results.xlsx` 查看結果。

## 檔案結構

### 輸入檔案

**`seo_search_keyword.xlsx`**
- 儲存待搜尋的關鍵字列表
- 格式：第一個工作表的 B 欄（第二欄）
- 第一列為標題列，從第二列開始為實際關鍵字

### 輸出檔案

**`seo_search_results.xlsx`**
- 自動按月份建立分頁（格式：`YYYY-MM`，如 `2025-01`）
- 每個分頁包含以下欄位：

  | 日期       | 關鍵字    | 排名 | 標題                     |
  |-----------|-----------|------|-------------------------|
  | 2025-01-15| 紅外光譜儀 | 1    | XXX 紅外光譜儀 - 官網    |
  | 2025-01-15| 紅外光譜儀 | 2    | XXX 公司 - 產品介紹      |
  | ...       | ...       | ...  | ...                     |

- 每次執行會將當日資料追加至對應月份分頁
- 累積歷史資料，方便追蹤排名變化

## 執行範例

```
==================================================
SEO 自動檢查工具
==================================================
✓ 成功載入 5 個關鍵字

[1/5] 正在搜尋關鍵字：紅外光譜儀

關鍵字「紅外光譜儀」的搜尋結果：
==================================================
1. XXX 紅外光譜儀 - 官網
2. XXX 公司 - 產品介紹
3. ...

✓ 搜尋結果已儲存至 seo_search_results.xlsx，分頁：2025-01

等待 5 秒後搜尋下一個關鍵字...

[2/5] 正在搜尋關鍵字：分光光度計
...

==================================================
✓ 所有關鍵字搜尋完成！共處理 5 個關鍵字
==================================================
```

## 注意事項

### 使用限制

1. **搜尋頻率**：關鍵字之間設有 5 秒等待時間，避免觸發 Google 反機器人機制
2. **結果數量**：每個關鍵字最多抓取前 10 名結果
3. **作業系統**：目前僅支援 macOS（使用 AppleScript 關閉瀏覽器）
4. **搜尋結果**：因 Google 搜尋結果會受地區、時間等因素影響，結果可能有所不同

### 建議事項

- **定期執行**：建議每日固定時間執行，以獲得一致的比較基準
- **備份資料**：定期備份 `seo_search_results.xlsx`，避免資料遺失
- **關鍵字管理**：妥善維護 `seo_search_keyword.xlsx`，保持關鍵字列表更新

## 技術架構

### 核心套件

- **Selenium**：瀏覽器自動化控制
- **openpyxl**：Excel 檔案讀寫
- **Chrome WebDriver**：Chrome 瀏覽器驅動

### 主要功能模組

- `load_keywords()`：從 Excel 讀取關鍵字列表
- `search_keyword()`：執行 Google 搜尋並抓取結果
- `save_to_excel()`：將結果儲存至 Excel 檔案
- `main()`：主程式流程控制

## 故障排除

### 找不到 ChromeDriver

確保系統已安裝 ChromeDriver 或由 Selenium 自動管理。

### 無法讀取關鍵字

檢查 `seo_search_keyword.xlsx` 是否存在，且關鍵字位於 B 欄（第二欄）。

### Excel 檔案無法開啟

確保執行程式時沒有同時開啟 `seo_search_results.xlsx`。

## 授權

本專案僅供內部使用，請勿用於商業用途或大量自動化搜尋。
